<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:geopad="clr-namespace:CsGrafeqApplication.Addons.GeometryPad;assembly=CsGrafeqApplication"
             xmlns:ctls="clr-namespace:CsGrafeqApplication.Controls;assembly=CsGrafeqApplication"
             xmlns:shapes="clr-namespace:CsGrafeq.Shapes;assembly=CsGrafeq.Shapes"
             xmlns:getter="clr-namespace:CsGrafeq.Shapes.ShapeGetter;assembly=CsGrafeq.Shapes"
             xmlns:shapes1="clr-namespace:CsGrafeq.Shapes"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="CsGrafeqApplication.Addons.GeometryPad.GeometryPad" x:DataType="geopad:GeometryPadViewModel">
    <UserControl.Styles>
        <Style Selector="Expander.NoBorderExpander">
            <Style Selector="^ /template/ ToggleButton#ExpanderHeader">
                <Setter Property="BorderThickness" Value="0,1,0,0" />
                <Setter Property="Background" Value="Transparent" />
            </Style>
            <Style Selector="^ /template/ Border#ExpanderContent">
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="Background" Value="Transparent" />
            </Style>
        </Style>
        <Style Selector="TextBox">
            <Setter Property="FontFamily" Value="{StaticResource MapleMono}" />
        </Style>
        <Style Selector="TextBlock">
            <Setter Property="FontFamily" Value="{StaticResource MapleMono}" />
        </Style>
        <Style Selector="TextBox DataValidationErrors">
            <Setter Property="Template">
                <ControlTemplate>
                    <DockPanel LastChildFill="True">
                        <ContentPresenter Background="{TemplateBinding Background}"
                                          BorderThickness="{TemplateBinding BorderThickness}"
                                          CornerRadius="{TemplateBinding CornerRadius}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          Content="{TemplateBinding Content}"
                                          Padding="{TemplateBinding Padding}" />
                    </DockPanel>
                </ControlTemplate>
            </Setter>
        </Style>
        <Style Selector="TextBox.NoDataValidation DataValidationErrors">
            <Setter Property="Template">
                <ControlTemplate>
                    <DockPanel LastChildFill="True">
                        <ContentPresenter CornerRadius="{TemplateBinding CornerRadius}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          Content="{TemplateBinding Content}"
                                          Padding="{TemplateBinding Padding}" />
                    </DockPanel>
                </ControlTemplate>
            </Setter>
        </Style>
        <Style Selector="TextBox.CommonTextBox">
            <Setter Property="AcceptsReturn" Value="False" />
            <Setter Property="MinWidth" Value="30" />
            <Setter Property="Width" Value="NaN" />
            <Setter Property="Height" Value="30" />
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="BorderThickness" Value="0" />
        </Style>
        <Style Selector="TextBox.Big">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="{DynamicResource CgForegroundBrush}" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>
        <Style Selector="TextBox.Small">
            <Setter Property="FontSize" Value="10" />
            <Setter Property="Foreground" Value="{DynamicResource CgHalfForegroundBrush}" />
            <Setter Property="Height" Value="20" />
        </Style>
        <Style Selector="TextBlock.Prompt">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="{DynamicResource CgHalfForegroundBrush}" />
        </Style>
        <Style Selector="RadioButton.GeoRadio">
            <Setter Property="Width" Value="45" />
            <Setter Property="Height" Value="45" />
            <Setter Property="GroupName" Value="GeoRadio" />
            <Setter Property="Template">
                <ControlTemplate>
                    <ContentPresenter Content="{TemplateBinding Content}"
                                      DataContext="{TemplateBinding DataContext}" />
                </ControlTemplate>
            </Setter>
            <Style Selector="^ /template/ ContentPresenter">
                <Setter Property="Background" Value="{DynamicResource CgTransparentBrush}" />
                <Setter Property="Transitions">
                    <Transitions>
                        <BrushTransition Duration="0:0:0.1" Property="Background" />
                    </Transitions>
                </Setter>
                <Setter Property="CornerRadius" Value="5" />
            </Style>
            <Style Selector="^:pointerover /template/ ContentPresenter">
                <Setter Property="Background" Value="{DynamicResource HTLightBrush}" />
            </Style>
            <Style Selector="^:checked /template/ ContentPresenter">
                <Setter Property="Background" Value="{DynamicResource HTMedianBrush}" />
            </Style>
        </Style>
        <Style Selector="CheckBox.VisibilityCheckBox">
            <Setter Property="Template">
                <ControlTemplate>
                    <Border BorderThickness="0">
                        <Panel Name="#PART_Container">
                            <Ellipse Width="20" Height="20" Stroke="{DynamicResource DarkBrush}"
                                     VerticalAlignment="Center" HorizontalAlignment="Center"
                                     StrokeThickness="1" Fill="White" ZIndex="0" />
                            <Ellipse Width="12" Height="12" VerticalAlignment="Center"
                                     HorizontalAlignment="Center" Name="PART_InnerCircle" ZIndex="1" />
                        </Panel>
                    </Border>
                </ControlTemplate>
            </Setter>
            <Style Selector="^ /template/ Ellipse#PART_InnerCircle">
                <Setter Property="Fill" Value="{DynamicResource HTLightBrush}" />
                <Setter Property="Transitions">
                    <Transitions>
                        <BrushTransition Property="Fill" Duration="0:0:0.1" />
                    </Transitions>
                </Setter>
            </Style>
            <Style Selector="^:checked /template/ Ellipse#PART_InnerCircle">
                <Setter Property="Fill" Value="{DynamicResource HTDarkBrush}" />
            </Style>
            <Style Selector="^ /template/ Panel#PART_Container">
                <Setter Property="Margin" Value="5,0" />
            </Style>
        </Style>
    </UserControl.Styles>
    <TabControl TabStripPlacement="Left" Name="TabControl" Margin="0" Padding="0"
                Background="Transparent">
        <TabItem>
            <TabItem.Header>
                <Svg Path="/Assets/input.svg" Width="25" Height="25" Margin="0"
                     Css="{DynamicResource OppositeCssPathFillString}" />
            </TabItem.Header>
            <DockPanel ZIndex="1" LastChildFill="True">
                <Border DockPanel.Dock="Top" HorizontalAlignment="Stretch">
                    <DockPanel LastChildFill="True" HorizontalAlignment="Stretch" Margin="5">
                        <Border Width="30" Height="30" DockPanel.Dock="Left">
                            <Svg Path="/Assets/add.svg" Width="25" Height="25" Margin="0" VerticalAlignment="Center"
                                 HorizontalAlignment="Center" Css="{DynamicResource OppositeCssPathFillString}"/>
                        </Border>
                        <Button DockPanel.Dock="Right" Margin="0" Background="Transparent" Width="30" HorizontalContentAlignment="Center" VerticalAlignment="Center" Click="AddFuncQuestionsClicked">?</Button>
                        <Border>
                            <TextBox BorderThickness="0" Classes="NoDataValidation" AcceptsReturn="False"
                                     AcceptsTab="False" KeyUp="NewFuncOnClick" Name="NewFuncTextBox" TemplateApplied="NewFuncTextBoxTemplateApplied"
                                     PropertyChanged="NewFuncPropertyChanged" Margin="0,0,5,0"/>
                        </Border>
                    </DockPanel>
                </Border>
                <ScrollViewer ZIndex="1">
                    <ItemsControl ItemsSource="{CompiledBinding Shapes}" Padding="0,0,0,5" Name="ShapeItemsControl">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel Orientation="Vertical" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemContainerTheme>
                            <ControlTheme TargetType="ContentPresenter">
                                <Setter Property="CornerRadius" Value="3" />
                            </ControlTheme>
                        </ItemsControl.ItemContainerTheme>
                        <ItemsControl.ItemTemplate>
                            <geopad:GeoShapeAndElseTemplate>
                                <geopad:GeoShapeAndElseTemplate.IsGeometryShape>
                                    <DataTemplate DataType="shapes:GeometryShape">
                                        <ctls:CheckedControl
                                            IsChecked="{CompiledBinding Selected, Mode=TwoWay}"
                                            IsOver="{CompiledBinding PointerOver, Mode=OneWayToSource}"
                                            Height="{CompiledBinding IsDeleted,Converter={StaticResource BoolToDouble},ConverterParameter='70',Mode=OneWay}"
                                            Color="{CompiledBinding Color}">
                                            <ctls:CheckedControl.Flyout>
                                                <Flyout ShowMode="Standard" Placement="BottomEdgeAlignedLeft">
                                                    <Grid ColumnDefinitions="80,120" RowDefinitions="Auto,Auto"
                                                          RowSpacing="3">
                                                        <TextBlock Grid.Row="0" Grid.Column="0"
                                                                   VerticalAlignment="Center">
                                                            Color:
                                                        </TextBlock>
                                                        <ColorPicker Grid.Column="1" Grid.Row="0"
                                                                     Color="{CompiledBinding Color,Converter={StaticResource UIntToColor}}"
                                                                     IsAlphaEnabled="False"
                                                                     IsAccentColorsVisible="False" />
                                                        <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center">Enabled</TextBlock>
                                                        <CheckBox Grid.Row="1" Grid.Column="1" IsChecked="{CompiledBinding IsUserEnabled}" HorizontalAlignment="Center"></CheckBox>
                                                    </Grid>
                                                </Flyout>
                                            </ctls:CheckedControl.Flyout>
                                            <DockPanel LastChildFill="True">
                                                <CheckBox
                                                    IsChecked="{CompiledBinding Visible,Mode=TwoWay}"
                                                    Classes="VisibilityCheckBox"
                                                    VerticalAlignment="Center" Margin="5" />
                                                <Button DockPanel.Dock="Right" VerticalAlignment="Center"
                                                        Tag="{CompiledBinding .}" Click="DeleteButtonClicked"
                                                        Background="{StaticResource HTMedianBrush}">
                                                    <Svg Path="/Assets/delete.svg" Width="20" Height="20" Margin="0"
                                                         Css="{DynamicResource OppositeCssPathFillString}" />
                                                </Button>
                                                <ContentControl Content="{CompiledBinding .}">
                                                    <ContentControl.ContentTemplate>
                                                        <geopad:ShapeTemplate>
                                                            <!--单独的点（PointGetter_FromLocation）-->
                                                            <geopad:ShapeTemplate.LocationPoint>
                                                                <DataTemplate DataType="shapes:Point">
                                                                    <DockPanel LastChildFill="True">
                                                                        <TextBox
                                                                            Text="{CompiledBinding Name,Mode=TwoWay}"
                                                                            Classes="CommonTextBox Big"
                                                                            Height="20"
                                                                            Margin="0"
                                                                            DockPanel.Dock="Left"
                                                                            Tapped="EventHandledTrue" />
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <TextBlock Text="=Point("
                                                                                    TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            <TextBox
                                                                                Text="{CompiledBinding ((getter:PointGetter_Movable)PointGetter).PointX.ValueStr,Mode=TwoWay}"
                                                                                Classes="CommonTextBox Big"

                                                                                KeyDown="TextBoxKeyDown"

                                                                                Tag="{CompiledBinding ((getter:PointGetter_Movable)PointGetter).PointX}"
                                                                                PropertyChanged="Number_OnPropertyChanged"
                                                                                Loaded="NumberTextBox_OnLoaded"
                                                                                Tapped="EventHandledTrue"
                                                                                Focusable="True"
                                                                                IsReadOnly="{CompiledBinding IsUserEnabled,Converter={StaticResource Not}}" />
                                                                            <TextBlock Text="," TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            <TextBox
                                                                                Text="{CompiledBinding ((getter:PointGetter_Movable)PointGetter).PointY.ValueStr,Mode=TwoWay}"
                                                                                Classes="CommonTextBox Big"

                                                                                Loaded="NumberTextBox_OnLoaded"
                                                                                KeyDown="TextBoxKeyDown"

                                                                                Tag="{CompiledBinding ((getter:PointGetter_Movable)PointGetter).PointY}"
                                                                                PropertyChanged="Number_OnPropertyChanged"
                                                                                Tapped="EventHandledTrue"
                                                                                Focusable="True"
                                                                                IsReadOnly="{CompiledBinding IsUserEnabled,Converter={StaticResource Not}}" />
                                                                            <TextBlock Text=")" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                        </StackPanel>
                                                                    </DockPanel>
                                                                </DataTemplate>
                                                            </geopad:ShapeTemplate.LocationPoint>
                                                            <!--在图形上的点（PointGetter_OnShape）-->
                                                            <geopad:ShapeTemplate.ControlledPoint>
                                                                <DataTemplate DataType="shapes:Point">
                                                                    <Grid ColumnDefinitions="Auto,*"
                                                                          RowDefinitions="Auto,Auto"
                                                                          VerticalAlignment="Center">
                                                                        <TextBox
                                                                            Text="{CompiledBinding Name,Mode=TwoWay}"
                                                                            Classes="CommonTextBox Big"
                                                                            Grid.Column="0" Grid.Row="0" Height="20"
                                                                            Margin="0"
                                                                            Tapped="EventHandledTrue" />
                                                                        <DockPanel Grid.Column="1"
                                                                                Grid.Row="0" LastChildFill="True">
                                                                            <StackPanel Orientation="Horizontal"
                                                                                    Background="Transparent"
                                                                                    Margin="0,5"
                                                                                    VerticalAlignment="Center">
                                                                                <TextBlock Text="=Controlled("
                                                                                    TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                                <TextBox
                                                                                    Text="{CompiledBinding ((getter:PointGetter_Movable)PointGetter).PointX.ValueStr,Mode=TwoWay}"
                                                                                    Classes="CommonTextBox Big"
                                                                                    KeyDown="TextBoxKeyDown"
                                                                                    PropertyChanged="Number_OnPropertyChanged"
                                                                                    Loaded="NumberTextBox_OnLoaded"
                                                                                    Tag="{CompiledBinding ((getter:PointGetter_Movable)PointGetter).PointX}"
                                                                                    Tapped="EventHandledTrue"
                                                                                    Focusable="True"
                                                                                    IsReadOnly="{CompiledBinding IsUserEnabled,Converter={StaticResource Not}}" />
                                                                                <TextBlock Text=","
                                                                                    TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                                <TextBox
                                                                                    Text="{CompiledBinding  ((getter:PointGetter_Movable)PointGetter).PointY.ValueStr,Mode=TwoWay}"
                                                                                    Classes="CommonTextBox Big"
                                                                                    KeyDown="TextBoxKeyDown"
                                                                                    PropertyChanged="Number_OnPropertyChanged"
                                                                                    Loaded="NumberTextBox_OnLoaded"
                                                                                    Tag="{CompiledBinding ((getter:PointGetter_Movable)PointGetter).PointX}"
                                                                                    Tapped="EventHandledTrue"
                                                                                    Focusable="True"
                                                                                    IsReadOnly="{CompiledBinding IsUserEnabled,Converter={StaticResource Not}}" />
                                                                                <TextBlock Text=")"
                                                                                    TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            </StackPanel>
                                                                        </DockPanel>
                                                                        <StackPanel
                                                                            DataContext="{CompiledBinding PointGetter}"
                                                                            Orientation="Horizontal"
                                                                            Background="Transparent" Margin="5"
                                                                            VerticalAlignment="Center" Grid.Column="1"
                                                                            Grid.Row="1">
                                                                            <TextBlock Text="On " TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Small" />
                                                                            <TextBlock
                                                                                Text="{CompiledBinding On.TypeName,Mode=TwoWay,DataType=getter:PointGetter_Movable}"
                                                                                Classes="CommonTextBox Small" />
                                                                            <TextBlock Text=" " TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Small" />
                                                                            <ctls:CheckedControl
                                                                                IsChecked="{CompiledBinding On.Selected, Mode=TwoWay,DataType=getter:PointGetter_Movable}"
                                                                                IsOver="{CompiledBinding On.PointerOver, Mode=OneWayToSource,DataType=getter:PointGetter_Movable}"
                                                                                Color="{CompiledBinding On.Color,DataType=getter:PointGetter_Movable}">
                                                                                <TextBlock
                                                                                    Text="{CompiledBinding On.Name,DataType=getter:PointGetter_Movable}"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Small" />
                                                                            </ctls:CheckedControl>
                                                                        </StackPanel>
                                                                    </Grid>
                                                                </DataTemplate>
                                                            </geopad:ShapeTemplate.ControlledPoint>
                                                            <!--基于其他点运算得得-->
                                                            <geopad:ShapeTemplate.CommonPoint>
                                                                <DataTemplate DataType="shapes:Point">
                                                                    <Grid ColumnDefinitions="Auto,Auto"
                                                                          RowDefinitions="Auto,Auto"
                                                                          VerticalAlignment="Center">
                                                                        <TextBox
                                                                            Text="{CompiledBinding Name,Mode=TwoWay}"
                                                                            Classes="CommonTextBox Big"
                                                                            Grid.Column="0" Grid.Row="0" Height="20"
                                                                            Margin="0" />
                                                                        <StackPanel Orientation="Horizontal"
                                                                                Background="Transparent" Margin="0,5"
                                                                                VerticalAlignment="Center"
                                                                                Grid.Column="1"
                                                                                Grid.Row="0">
                                                                            <TextBlock Text="=" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            <TextBlock
                                                                                Text="{CompiledBinding PointGetter.ActionName}"
                                                                                TextAlignment="Left"
                                                                                VerticalAlignment="Center"
                                                                                Classes="Big" />
                                                                            <TextBlock Text="(" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            <ContentControl
                                                                                Content="{CompiledBinding PointGetter.Parameters}">
                                                                                <ContentControl.ContentTemplate>
                                                                                    <geopad:ShapeShowCaseDataTemplate>
                                                                                        <geopad:ShapeShowCaseDataTemplate.ShapeShowcaseTemplate>
                                                                                            <DataTemplate
                                                                                                DataType="shapes:GeometryShape">
                                                                                                <ctls:CheckedControl
                                                                                                    IsChecked="{CompiledBinding Selected, Mode=TwoWay}"
                                                                                                    IsOver="{CompiledBinding PointerOver, Mode=OneWayToSource}"
                                                                                                    Color="{DynamicResource MedianUint}">
                                                                                                    <TextBlock
                                                                                                        Text="{CompiledBinding Name}" />
                                                                                                </ctls:CheckedControl>
                                                                                            </DataTemplate>
                                                                                        </geopad:ShapeShowCaseDataTemplate.ShapeShowcaseTemplate>
                                                                                    </geopad:ShapeShowCaseDataTemplate>
                                                                                </ContentControl.ContentTemplate>
                                                                            </ContentControl>
                                                                            <TextBlock Text=")" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                        </StackPanel>
                                                                        <StackPanel Orientation="Horizontal"
                                                                                Background="Transparent" Margin="5"
                                                                                VerticalAlignment="Center"
                                                                                Grid.Column="1"
                                                                                Grid.Row="1">
                                                                            <TextBlock Text="=(" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Small" />
                                                                            <TextBlock
                                                                                Text="{CompiledBinding  Location.X,Mode=OneWay}"
                                                                                Classes="CommonTextBox Small" />
                                                                            <TextBlock Text="," TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Small" />
                                                                            <TextBlock
                                                                                Text="{CompiledBinding Location.Y,Mode=OneWay}"
                                                                                Classes="CommonTextBox Small" />
                                                                            <TextBlock Text=")" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Small" />
                                                                        </StackPanel>
                                                                    </Grid>
                                                                </DataTemplate>
                                                            </geopad:ShapeTemplate.CommonPoint>
                                                            <!--普通图形-->
                                                            <geopad:ShapeTemplate.Common>
                                                                <DataTemplate DataType="shapes:GeometryShape">
                                                                    <Grid ColumnDefinitions="Auto,Auto"
                                                                          RowDefinitions="Auto,Auto"
                                                                          VerticalAlignment="Center">
                                                                        <TextBox
                                                                            Text="{CompiledBinding Name,Mode=TwoWay}"
                                                                            Classes="CommonTextBox Big"
                                                                            Grid.Column="0" Grid.Row="0" Height="20"
                                                                            Margin="0"
                                                                            Tapped="EventHandledTrue" />
                                                                        <StackPanel Orientation="Horizontal"
                                                                                Background="Transparent" Margin="0,5"
                                                                                VerticalAlignment="Center"
                                                                                Grid.Column="1"
                                                                                Grid.Row="0">
                                                                            <TextBlock Text="=" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            <TextBlock
                                                                                Text="{CompiledBinding Getter.ActionName}"
                                                                                TextAlignment="Left"
                                                                                VerticalAlignment="Center"
                                                                                Classes="Big" />
                                                                            <TextBlock Text="(" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            <ContentControl
                                                                                Content="{CompiledBinding Getter.Parameters}">
                                                                                <ContentControl.ContentTemplate>
                                                                                    <geopad:ShapeShowCaseDataTemplate>
                                                                                        <geopad:ShapeShowCaseDataTemplate.ShapeShowcaseTemplate>
                                                                                            <DataTemplate
                                                                                                DataType="shapes:GeometryShape">
                                                                                                <ctls:CheckedControl
                                                                                                    IsChecked="{CompiledBinding Selected, Mode=TwoWay}"
                                                                                                    IsOver="{CompiledBinding PointerOver, Mode=OneWayToSource}"
                                                                                                    Color="{CompiledBinding Color}">
                                                                                                    <TextBlock
                                                                                                        Text="{CompiledBinding Name}" />
                                                                                                </ctls:CheckedControl>
                                                                                            </DataTemplate>
                                                                                        </geopad:ShapeShowCaseDataTemplate.ShapeShowcaseTemplate>
                                                                                    </geopad:ShapeShowCaseDataTemplate>
                                                                                </ContentControl.ContentTemplate>
                                                                            </ContentControl>
                                                                            <TextBlock Text=")" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                        </StackPanel>
                                                                        <TextBlock Text="{CompiledBinding Description}"
                                                                                Grid.Column="1" Grid.Row="1"
                                                                                Classes="Small" />
                                                                    </Grid>
                                                                </DataTemplate>
                                                            </geopad:ShapeTemplate.Common>
                                                            <!---->
                                                            <geopad:ShapeTemplate.RadiusCircle>
                                                                <DataTemplate DataType="shapes:Circle">
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBox
                                                                            Text="{CompiledBinding Name,Mode=TwoWay}"
                                                                            Classes="CommonTextBox Big"
                                                                            Height="20"
                                                                            Margin="0"
                                                                            Tapped="EventHandledTrue" />
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <TextBlock Text="=Circle("
                                                                                    TextAlignment="Left"
                                                                                    Classes="Big"
                                                                                    VerticalAlignment="Center" />
                                                                            <TextBlock Text="Center:" Classes="Prompt"
                                                                                    VerticalAlignment="Center" />
                                                                            <ctls:CheckedControl
                                                                                IsChecked="{CompiledBinding Selected, Mode=TwoWay}"
                                                                                IsOver="{CompiledBinding PointerOver, Mode=OneWayToSource}"
                                                                                Color="{CompiledBinding Color}"
                                                                                DataContext="{CompiledBinding ((getter:CircleGetter_FromCenterAndRadius)Getter).Center}"
                                                                                VerticalAlignment="Center">
                                                                                <TextBlock
                                                                                    Text="{CompiledBinding Name}"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Small" />
                                                                            </ctls:CheckedControl>
                                                                            <TextBlock Text="," TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                            <TextBox
                                                                                Text="{CompiledBinding ((getter:CircleGetter_FromCenterAndRadius)Getter).Radius.ValueStr,Mode=TwoWay}"
                                                                                Classes="CommonTextBox Big"
                                                                                Tag="{CompiledBinding Path=((getter:CircleGetter_FromCenterAndRadius)Getter).Radius}"
                                                                                PropertyChanged="Number_OnPropertyChanged"
                                                                                Tapped="EventHandledTrue"
                                                                                IsReadOnly="{CompiledBinding IsUserEnabled,Converter={StaticResource Not},Converter={StaticResource Not}}"/>
                                                                            <TextBlock Text=")" TextAlignment="Left"
                                                                                    VerticalAlignment="Center"
                                                                                    Classes="Big" />
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </geopad:ShapeTemplate.RadiusCircle>
                                                        </geopad:ShapeTemplate>
                                                    </ContentControl.ContentTemplate>
                                                </ContentControl>
                                            </DockPanel>
                                        </ctls:CheckedControl>
                                    </DataTemplate>
                                </geopad:GeoShapeAndElseTemplate.IsGeometryShape>
                                <geopad:GeoShapeAndElseTemplate.IsElse>
                                    <DataTemplate DataType="shapes1:ImplicitFunction">
                                        <Border
                                            Background="{CompiledBinding Color,Converter={StaticResource UIntColorToBrush},ConverterParameter=140}"
                                            Height="{CompiledBinding IsDeleted,Converter={StaticResource BoolToDouble},ConverterParameter='70',Mode=OneWay}"
                                            IsVisible="{CompiledBinding IsDeleted,Converter={StaticResource Not}}"
                                            CornerRadius="5" BorderThickness="0" Tapped="ImpFuncOnTapped">
                                            <FlyoutBase.AttachedFlyout>
                                                <Flyout ShowMode="Standard" Placement="BottomEdgeAlignedLeft">
                                                    <Grid ColumnDefinitions="80,120" RowDefinitions="Auto,Auto,Auto"
                                                          RowSpacing="3">
                                                        <TextBlock Grid.Row="0" Grid.Column="0"
                                                                   VerticalAlignment="Center">
                                                            Color:
                                                        </TextBlock>
                                                        <ColorPicker Grid.Column="1" Grid.Row="0"
                                                                     Color="{CompiledBinding Color,Converter={StaticResource UIntToColor}}"
                                                                     IsAlphaVisible="False"
                                                                     IsAccentColorsVisible="False" />
                                                        <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center">Show Formula:</TextBlock>
                                                        <CheckBox Grid.Row="1" Grid.Column="1" IsChecked="{CompiledBinding ShowFormula}" VerticalAlignment="Center" HorizontalAlignment="Center"></CheckBox>
                                                        <TextBlock Grid.Row="2" Grid.Column="0" VerticalAlignment="Center">Opacity:</TextBlock>
                                                        <Slider Grid.Row="2" Grid.Column="1" Value="{CompiledBinding Opacity}" Minimum="0" Maximum="255" VerticalAlignment="Center" HorizontalAlignment="Stretch"></Slider>
                                                    </Grid>
                                                </Flyout>
                                            </FlyoutBase.AttachedFlyout>
                                            <DockPanel LastChildFill="True">
                                                <CheckBox
                                                    IsChecked="{CompiledBinding Visible,Mode=TwoWay}"
                                                    Classes="VisibilityCheckBox"
                                                    VerticalAlignment="Center" Margin="5" />
                                                <Button DockPanel.Dock="Right" VerticalAlignment="Center"
                                                        Tag="{CompiledBinding .}" Click="DeleteButtonClicked"
                                                        Tapped="EventHandledTrue"
                                                        Background="{StaticResource HTMedianBrush}">
                                                    <Svg Path="/Assets/delete.svg" Width="20" Height="20" Margin="0"
                                                         Css="{DynamicResource OppositeCssPathFillString}" />
                                                </Button>
                                                <TextBox
                                                    Text="{CompiledBinding Expression,Mode=TwoWay}"
                                                    Tapped="EventHandledTrue" PropertyChanged="ImpFuncPropertyChanged"
                                                    Tag="{CompiledBinding .}" Loaded="ImpFuncLoaded"
                                                    Classes="CommonTextBox Big" HorizontalAlignment="Left" />
                                            </DockPanel>
                                        </Border>
                                    </DataTemplate>
                                </geopad:GeoShapeAndElseTemplate.IsElse>
                            </geopad:GeoShapeAndElseTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </DockPanel>
        </TabItem>
        <TabItem>
            <TabItem.Header>
                <Svg Path="/Assets/shape.svg" Width="25" Height="25" Margin="0"
                     Css="{DynamicResource OppositeCssPathFillString}" />
            </TabItem.Header>
            <ScrollViewer Name="PART_ActionViewer">
                <ItemsControl ItemsSource="{CompiledBinding Actions}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel Orientation="Vertical" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate DataType="geopad:HasNameActionList">
                                <Expander Classes="NoBorderExpander" BorderThickness="0" TemplateApplied="Expander_TemplateApplied"
                                          IsExpanded="True" CornerRadius="0" HorizontalAlignment="Stretch"
                                          Width="{CompiledBinding $parent[StackPanel].Bounds.Width}"
                                          Padding="0" Background="Transparent">
                                    <Expander.Header>
                                        <TextBlock Text="{CompiledBinding Name.Data }" Margin="0"
                                                   Padding="0" />
                                    </Expander.Header>
                                    <Border Padding="10,0" Background="Transparent">
                                        <ItemsControl ItemsSource="{CompiledBinding .}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel Orientation="Horizontal" ItemSpacing="5" LineSpacing="5"
                                                               Background="Transparent" Margin="0" />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <RadioButton Classes="GeoRadio"
                                                                 IsCheckedChanged="RadioButtonChecked"
                                                                 Tag="{CompiledBinding .}">
                                                        <TextBlock VerticalAlignment="Center"
                                                                   HorizontalAlignment="Center"
                                                                   TextWrapping="Wrap" FontSize="11"
                                                                   TextAlignment="Center" Name="RadioText"
                                                                   Text="{CompiledBinding Name.Data}" />
                                                    </RadioButton>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </Border>
                                </Expander>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </TabItem>
        <TabItem>
            <TabItem.Header>
                <Svg Path="/Assets/slider.svg" Width="25" Height="25" Margin="0"
                     Css="{DynamicResource OppositeCssPathFillString}" />
            </TabItem.Header>
            <ScrollViewer Name="PART_VariableViewer">
                <StackPanel Orientation="Vertical">
                    <ctls:VariableBox ValueName="a" Value="{CompiledBinding Variables.A,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[0],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="b" Value="{CompiledBinding Variables.B,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[1],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="c" Value="{CompiledBinding Variables.C,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[2],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="d" Value="{CompiledBinding Variables.D,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[3],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="f" Value="{CompiledBinding Variables.F,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[5],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="g" Value="{CompiledBinding Variables.G,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[6],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="h" Value="{CompiledBinding Variables.H,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[7],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="i" Value="{CompiledBinding Variables.I,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[8],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="j" Value="{CompiledBinding Variables.J,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[9],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="k" Value="{CompiledBinding Variables.K,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[10],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="l" Value="{CompiledBinding Variables.L,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[11],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="m" Value="{CompiledBinding Variables.M,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[12],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="n" Value="{CompiledBinding Variables.N,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[13],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="o" Value="{CompiledBinding Variables.O,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[14],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="p" Value="{CompiledBinding Variables.P,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[15],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="q" Value="{CompiledBinding Variables.Q,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[16],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="r" Value="{CompiledBinding Variables.R,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[17],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="s" Value="{CompiledBinding Variables.S,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[18],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="t" Value="{CompiledBinding Variables.T,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[19],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="u" Value="{CompiledBinding Variables.U,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[20],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="v" Value="{CompiledBinding Variables.V,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[21],Converter={StaticResource IntToBool},Mode=OneWay}" />
                    <ctls:VariableBox ValueName="w" Value="{CompiledBinding Variables.W,Mode=TwoWay}"
                                      IsVisible="{CompiledBinding Variables.CharsReferenceCounter[22],Converter={StaticResource IntToBool},Mode=OneWay}" />
                </StackPanel>
            </ScrollViewer>
        </TabItem>
    </TabControl>
</UserControl>